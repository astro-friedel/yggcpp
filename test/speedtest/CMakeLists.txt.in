cmake_minimum_required(VERSION 3.16)
set(LANG @LANGUAGE@)
if (LANG STREQUAL "CXX")
  project(SpeedTest@LANGUAGE@ @LANGUAGE@)
else()
  project(SpeedTest@LANGUAGE@ @LANGUAGE@ CXX)
endif()

set(CMAKE_PREFIX_PATH @CMAKE_PREFIX_PATH@)
set(Python3_ROOT_DIR @Python3_ROOT_DIR@)
find_package(YggInterface REQUIRED)

add_executable(speedtest_@LANGUAGE@ speedtest.@LANGUAGE_EXT@)
set_target_properties(speedtest_@LANGUAGE@ PROPERTIES
                      LINKER_LANGUAGE @LANGUAGE@)
target_link_libraries(speedtest_@LANGUAGE@ PRIVATE
                      YggInterface::@LANGUAGE@)
include(CheckDLL)
show_runtimes(speedtest_@LANGUAGE@)
if (WIN32)
    if (CONDA_PREFIX)
        add_custom_command(
            TARGET speedtest_@LANGUAGE@
            POST_BUILD
            COMMAND ${CMAKE_COMMAND} -E copy $<TARGET_FILE:YggInterface> $<TARGET_FILE_DIR:speedtest_@LANGUAGE@>
            COMMAND_EXPAND_LISTS
        )
    else()
        add_custom_command(
            TARGET speedtest_@LANGUAGE@
            POST_BUILD
            COMMAND ${CMAKE_COMMAND} -E copy $<TARGET_RUNTIME_DLLS:speedtest_@LANGUAGE@> $<TARGET_FILE_DIR:speedtest_@LANGUAGE@>
            COMMAND_EXPAND_LISTS
        )
    endif()
endif ()
